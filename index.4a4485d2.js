!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,r=Array(e);a<e;a++)r[a]=t[a];return r}function e(e){return function(e){if(Array.isArray(e))return t(e)}(e)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(e)||function(e,a){if(e){if("string"==typeof e)return t(e,void 0);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(r);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,void 0)}}(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var a,r,n,s,o=new/*#__PURE__*/(function(){var t;function a(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.statusGame="idle",this.gameScore=0,this.gameStatus=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.tableStart=this.gameStatus.map(function(t){return e(t)})}return t=[{key:"moveLeft",value:function(){var t=this;if("playing"===this.statusGame){for(var e=!1,a=0;a<this.gameStatus.length;a++)!function(a){var r=t.gameStatus[a].filter(function(t){return 0!==t});r=t.cellGood(r);for(var n=0;n<r.length;n++)t.gameStatus[a][n]!==r[n]&&(t.gameStatus[a]=r,e=!0)}(a);e&&(this.randomCells(),this.getScore())}}},{key:"moveRight",value:function(){var t=this;if("playing"===this.statusGame){for(var a=!1,r=0;r<this.gameStatus.length;r++)!function(r){var n=e(t.gameStatus[r]).reverse(),s=n.filter(function(t){return 0!==t});(s=t.cellGood(s)).reverse();for(var o=0;o<n.length;o++)t.gameStatus[r][o]!==s[o]&&(t.gameStatus[r]=s,a=!0)}(r);a&&(this.randomCells(),this.getScore())}}},{key:"moveUp",value:function(){var t=this,e=function(e){var r=t.gameStatus.map(function(t){return t[e]}),n=r.filter(function(t){return 0!==t});n=t.cellGood(n);for(var s=0;s<r.length;s++)t.gameStatus[s][e]!==n[s]&&(a=!0,t.gameStatus[s][e]=n[s])};if("playing"===this.statusGame){for(var a=!1,r=0;r<this.gameStatus.length;r++)e(r);a&&(this.randomCells(),this.getScore())}}},{key:"moveDown",value:function(){var t=this,e=function(e){var r=t.gameStatus.map(function(t){return t[e]}).reverse(),n=r.filter(function(t){return 0!==t});(n=t.cellGood(n)).reverse();for(var s=0;s<r.length;s++)t.gameStatus[s][e]!==n[s]&&(a=!0,t.gameStatus[s][e]=n[s])};if("playing"===this.statusGame){for(var a=!1,r=0;r<this.gameStatus.length;r++)e(r);a&&(this.randomCells(),this.getScore())}}},{key:"getScore",value:function(){return this.winGame(),this.loseGame(),this.gameScore}},{key:"getState",value:function(){return this.gameStatus}},{key:"getStatus",value:function(){return this.statusGame}},{key:"start",value:function(){return this.statusGame="playing",this.randomCells(2),this}},{key:"restart",value:function(){this.gameStatus=this.tableStart.map(function(t){return e(t)}),this.statusGame="idle",this.gameScore=0,this.getScore()}},{key:"randomCells",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=0;e<t;e++){var a=Math.random()>.9?4:2,r=Math.floor(4*Math.random()),n=Math.floor(4*Math.random());0===this.gameStatus[r][n]?this.gameStatus[r][n]=a:this.randomCells(1)}}},{key:"cellGood",value:function(t){for(var a=e(t),r=0;r<a.length;r++)a[r]===a[r+1]&&(a[r]*=2,this.gameScore+=+a[r],a.splice(r+1,1));for(a=a.filter(function(t){return 0!==t});a.length<4;)a.push(0);return a}},{key:"winGame",value:function(){this.gameStatus.flat().some(function(t){return 2048===t})&&(this.statusGame="win")}},{key:"loseGame",value:function(){for(var t=this,e=function(e){var a=t.gameStatus[e],r=t.gameStatus.map(function(t){return t[e]});if(r.includes(0)||a.includes(0))return{v:void 0};for(var n=0;n<a.length;n++)if(a[n]===a[n+1])return{v:void 0};for(var s=0;s<a.length;s++)if(r[s]===r[s+1])return{v:void 0}},a=0;a<this.gameStatus.length;a++){var r=e(a);if("object"==(r&&"undefined"!=typeof Symbol&&r.constructor===Symbol?"symbol":typeof r))return r.v}this.statusGame="lose"}}],function(t,e){for(var a=0;a<e.length;a++){var r=e[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}(a.prototype,t),a}())([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),i=document.querySelector(".button"),u=document.querySelectorAll(".field-cell"),l=document.querySelectorAll(".message"),c=document.querySelector(".message-lose"),m=document.querySelector(".message-win"),f=document.querySelector(".game-score"),h=!1;function g(t){for(var e=function(t){var e=0===a[t]?"":a[t];u[t].textContent=e,u[t].classList="field-cell field-cell--".concat(e),0===a[t]||u[t].classList.contains("cell-new")||(u[t].classList.add("cell-new"),setTimeout(function(){return u[t].classList.remove("cell-new")},200))},a=t||o.gameStatus.flat(),r=0;r<a.length;r++)e(r);f.textContent=o.gameScore,"lose"===o.statusGame&&(c.classList="message message-lose",o.getStatus()),"win"===o.statusGame&&(m.classList="message message-win",o.getStatus())}i.addEventListener("click",function(t){if(i.classList.add("restart"),i.textContent="Restart",l.forEach(function(t){return t.classList.add("hidden")}),t.target.classList.contains("start")){i.classList.remove("start"),i.classList.add("restart"),i.textContent="Restart",h=!0,o.start(),g(),h&&document.addEventListener("keydown",function(t){switch(t.key){case"ArrowLeft":o.moveLeft(),g();break;case"ArrowRight":o.moveRight(),g();break;case"ArrowUp":o.moveUp(),g();break;case"ArrowDown":o.moveDown(),g()}});return}t.target.classList.contains("restart")&&(i.classList.add("start"),i.classList.remove("restart"),i.textContent="Start",o.restart(),g())}),document.addEventListener("touchstart",function(t){a=t.touches[0].clientX,r=t.touches[0].clientY}),document.addEventListener("touchend",function(t){n=t.changedTouches[0].clientX,s=t.changedTouches[0].clientY;var e=n-a,i=s-r;Math.abs(e)>Math.abs(i)?e>30?o.moveRight():e<-30&&o.moveLeft():i>30?o.moveDown():i<-30&&o.moveUp(),g()})}();
//# sourceMappingURL=index.4a4485d2.js.map
