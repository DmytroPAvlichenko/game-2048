let t,e,s,a;const l=new class{constructor(t){this.statusGame="idle",this.gameScore=0,this.gameStatus=t||[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.tableStart=this.gameStatus.map(t=>[...t])}moveLeft(){if("playing"!==this.statusGame)return;let t=!1;for(let e=0;e<this.gameStatus.length;e++){let s=this.gameStatus[e].filter(t=>0!==t);s=this.cellGood(s);for(let a=0;a<s.length;a++)this.gameStatus[e][a]!==s[a]&&(this.gameStatus[e]=s,t=!0)}t&&(this.randomCells(),this.getScore())}moveRight(){if("playing"!==this.statusGame)return;let t=!1;for(let e=0;e<this.gameStatus.length;e++){let s=[...this.gameStatus[e]].reverse(),a=s.filter(t=>0!==t);(a=this.cellGood(a)).reverse();for(let l=0;l<s.length;l++)this.gameStatus[e][l]!==a[l]&&(this.gameStatus[e]=a,t=!0)}t&&(this.randomCells(),this.getScore())}moveUp(){if("playing"!==this.statusGame)return;let t=!1;for(let e=0;e<this.gameStatus.length;e++){let s=this.gameStatus.map(t=>t[e]),a=s.filter(t=>0!==t);a=this.cellGood(a);for(let l=0;l<s.length;l++)this.gameStatus[l][e]!==a[l]&&(t=!0,this.gameStatus[l][e]=a[l])}t&&(this.randomCells(),this.getScore())}moveDown(){if("playing"!==this.statusGame)return;let t=!1;for(let e=0;e<this.gameStatus.length;e++){let s=this.gameStatus.map(t=>t[e]).reverse(),a=s.filter(t=>0!==t);(a=this.cellGood(a)).reverse();for(let l=0;l<s.length;l++)this.gameStatus[l][e]!==a[l]&&(t=!0,this.gameStatus[l][e]=a[l])}t&&(this.randomCells(),this.getScore())}getScore(){return this.winGame(),this.loseGame(),this.gameScore}getState(){return this.gameStatus}getStatus(){return this.statusGame}start(){return this.statusGame="playing",this.randomCells(2),this}restart(){this.gameStatus=this.tableStart.map(t=>[...t]),this.statusGame="idle",this.gameScore=0,this.getScore()}randomCells(t=1){for(let e=0;e<t;e++){let t=Math.random()>.9?4:2,e=Math.floor(4*Math.random()),s=Math.floor(4*Math.random());0===this.gameStatus[e][s]?this.gameStatus[e][s]=t:this.randomCells(1)}}cellGood(t){let e=[...t];for(let t=0;t<e.length;t++)e[t]===e[t+1]&&(e[t]*=2,this.gameScore+=+e[t],e.splice(t+1,1));for(e=e.filter(t=>0!==t);e.length<4;)e.push(0);return e}winGame(){this.gameStatus.flat().some(t=>2048===t)&&(this.statusGame="win")}loseGame(){for(let t=0;t<this.gameStatus.length;t++){let e=this.gameStatus[t],s=this.gameStatus.map(e=>e[t]);if(s.includes(0)||e.includes(0))return;for(let t=0;t<e.length;t++)if(e[t]===e[t+1])return;for(let t=0;t<e.length;t++)if(s[t]===s[t+1])return}this.statusGame="lose"}}([[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]),r=document.querySelector(".button"),i=document.querySelectorAll(".field-cell"),o=document.querySelectorAll(".message"),n=document.querySelector(".message-lose"),h=document.querySelector(".message-win"),m=document.querySelector(".game-score");let c=!1;function u(t){let e=t||l.gameStatus.flat();for(let t=0;t<e.length;t++){let s=0===e[t]?"":e[t];i[t].textContent=s,i[t].classList=`field-cell field-cell--${s}`,0===e[t]||i[t].classList.contains("cell-new")||(i[t].classList.add("cell-new"),setTimeout(()=>i[t].classList.remove("cell-new"),200))}m.textContent=l.gameScore,"lose"===l.statusGame&&(n.classList="message message-lose",l.getStatus()),"win"===l.statusGame&&(h.classList="message message-win",l.getStatus())}r.addEventListener("click",t=>{if(r.classList.add("restart"),r.textContent="Restart",o.forEach(t=>t.classList.add("hidden")),t.target.classList.contains("start")){r.classList.remove("start"),r.classList.add("restart"),r.textContent="Restart",c=!0,l.start(),u(),c&&document.addEventListener("keydown",t=>{switch(t.key){case"ArrowLeft":l.moveLeft(),u();break;case"ArrowRight":l.moveRight(),u();break;case"ArrowUp":l.moveUp(),u();break;case"ArrowDown":l.moveDown(),u()}});return}t.target.classList.contains("restart")&&(r.classList.add("start"),r.classList.remove("restart"),r.textContent="Start",l.restart(),u())}),document.addEventListener("touchstart",s=>{t=s.touches[0].clientX,e=s.touches[0].clientY}),document.addEventListener("touchend",r=>{s=r.changedTouches[0].clientX,a=r.changedTouches[0].clientY;let i=s-t,o=a-e;Math.abs(i)>Math.abs(o)?i>30?l.moveRight():i<-30&&l.moveLeft():o>30?l.moveDown():o<-30&&l.moveUp(),u()});
//# sourceMappingURL=index.e01023e9.js.map
